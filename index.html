<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flip Clock | Prankul Shukla</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flipclock/0.7.8/flipclock.min.css">

<style>
:root{
  --bg:#f4f4f4;
  --text:#111;
  --panel:#fff;
  --btn:#e5e5e5;
  --btnText:#111;
  --flipBg:#000;
  --flipText:#fff;
}
body.dark{
  --bg:#000;
  --text:#fff;
  --panel:#111;
  --btn:#1f1f1f;
  --btnText:#fff;
  --flipBg:#fff;
  --flipText:#000;
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial,sans-serif;
  min-height:100vh;
  overflow:hidden;
  background-size:cover;
  background-position:center;
  transition:0.3s;
}

/* SLIDER */
.wrapper{ width:200%; display:flex; transition:0.4s ease; }
.page{
  width:50%;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* CLOCK */
.clock-box{
  text-align:center;
  display:flex;
  flex-direction:column;
  align-items:center;
}
.date{ font-size:22px; margin-bottom:6px; }
.clock{ zoom:1.9; }

/* TIMER */
.timer-box{
  background:var(--panel);
  padding:20px 30px;
  border-radius:14px;
  text-align:center;
}
.timer-box input{
  width:60px;
  padding:6px;
  margin:5px;
  text-align:center;
}
.timer{ margin-top:10px; }

/* BOTTOM BAR */
.bottombar{
  position:fixed;
  bottom:15px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
}
button{
  background:var(--btn);
  color:var(--btnText);
  border:none;
  padding:8px 14px;
  border-radius:6px;
  cursor:pointer;
}

/* FLIP COLORS */
.flip-clock-wrapper ul li a div div.inn{
  background:var(--flipBg)!important;
  color:var(--flipText)!important; 
}

/* MEDIA QUERIES */

/* TABLET & SMALL LAPTOP */
@media (max-width: 1024px){
  .clock{ zoom:1.6; }
  .timer{ zoom:1.0; }
  .date{ font-size:20px; }
}

/* PHONE – LANDSCAPE */
@media (max-width: 900px) and (orientation: landscape){
  .clock{ zoom:1.25; }
  .timer{ zoom:1.0; }
  .date{ font-size:18px; margin-bottom:8px; }
  .timer-box{ padding:26px 30px; }
  .timer-box input{ width:60px; font-size:16px; padding:7px; }
}

/* PHONE – PORTRAIT */
@media (max-width: 768px){
  .clock{ zoom:1.25; }
  .timer{ zoom:0.9; }
  .date{ font-size:16px; }
  .timer-box{ padding:26px 30px; }
  .timer-box input{ width:60px; font-size:16px; padding:7px; }
}

/* SMALL PHONES */
@media (max-width: 480px){
  .clock{ zoom:0.85; }
  .timer{ zoom:0.8; }
  .date{ font-size:14px; }
}

/* VERY SMALL PHONES */
@media (max-width: 360px){
  .clock{ zoom:0.75; }
  .timer{ zoom:0.7; }
}

/* LOW HEIGHT DEVICES */
@media (max-height: 420px){
  .clock{ zoom:0.9; }
  .timer{ zoom:0.85; }
}
</style>
</head>

<body>

<div class="wrapper" id="slider">

<!-- CLOCK -->
<div class="page">
  <div class="clock-box">
    <div class="date" id="date"></div>
    <div class="clock"></div>
  </div>
</div>

<!-- TIMER -->
<div class="page timer-page">
  <div class="timer-box">
    <div id="timerInputs">
      <input id="hh" type="number" value="0">
      <input id="mm" type="number" value="1">
      <input id="ss" type="number" value="0"><br>
      <input type="file" id="sound" accept="audio/*"><br>
      <button onclick="startTimer()">Start</button>
    </div>
    <div class="timer"></div>
  </div>
</div>

</div>

<!-- BOTTOM BAR -->
<div class="bottombar" id="bottombar">
  <button onclick="toggleMode()" id="modeBtn">Dark</button>
  <button onclick="toggleFormat()" id="formatBtn">12 HR</button>
  
  <button onclick="uploadBg()">Background</button>
  <button onclick="removeBg()" id="delBgBtn" style="display:none">Delete Background</button>
  <button onclick="goFullscreen()" id="fullBtn">Full</button>
</div>

<input type="file" id="bgInput" hidden>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/flipclock/0.7.8/flipclock.min.js"></script>

<script>
let is24=false;
let clock,timerClock;
let alarmAudio=null;
let alarmTimeout=null;
const defaultAudioSrc="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg";

/* CLOCK INIT */
function initClock(){
  if(clock) clock.stop();
  $('.clock').html('');
  clock=$('.clock').FlipClock({
    clockFace:is24?'TwentyFourHourClock':'TwelveHourClock',
    showSeconds:true,
    showMeridian:true
  });
}
initClock();

/* DATE */
function updateDate(){
  date.innerText=new Date().toLocaleDateString('en-IN',{
    weekday:'long',day:'numeric',month:'long',year:'numeric'
  });
}
updateDate(); setInterval(updateDate,60000);

/* MODE */
function toggleMode(){
  document.body.classList.toggle("dark");
  modeBtn.innerText=document.body.classList.contains("dark")?"Light":"Dark";
  initClock();
}

/* FORMAT */
function toggleFormat(){
  is24=!is24;
  formatBtn.innerText=is24?"24 HR":"12 HR";
  initClock();
}

/* BACKGROUND */
function uploadBg(){ bgInput.click(); }
bgInput.addEventListener("change",()=> {
  const f = bgInput.files[0];
  if(!f) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.body.style.backgroundImage=`url(${e.target.result})`;
    localStorage.setItem("wall",e.target.result);
    delBgBtn.style.display="inline-block";
  };
  reader.readAsDataURL(f);
});
function removeBg(){
  document.body.style.backgroundImage="none";
  localStorage.removeItem("wall");
  delBgBtn.style.display="none";
}
if(localStorage.getItem("wall")){
  document.body.style.backgroundImage=`url(${localStorage.getItem("wall")})`;
  delBgBtn.style.display="inline-block";
}

/* SLIDER WITH TOUCH SUPPORT */
let startX=0;
slider.addEventListener("mousedown",e=>startX=e.clientX);
slider.addEventListener("mouseup",e=>{
  if(startX-e.clientX>100) goTimer();
  if(e.clientX-startX>100) goClock();
});
slider.addEventListener("touchstart", e=>startX=e.touches[0].clientX);
slider.addEventListener("touchend", e=>{
  let endX=e.changedTouches[0].clientX;
  if(startX-endX>50) goTimer();
  if(endX-startX>50) goClock();
});
function goTimer(){ slider.style.transform="translateX(-50%)"; }
function goClock(){ slider.style.transform="translateX(0)"; }

/* TIMER */
function startTimer(){
  const t=(+hh.value*3600)+(+mm.value*60)+(+ss.value);
  if(t<=0) return;
  timerInputs.style.display="none";
  $('.timer').html('');
  if(timerClock) timerClock.stop();
  if(alarmAudio) alarmAudio.pause();
  if(alarmTimeout) clearTimeout(alarmTimeout);
  timerClock=$('.timer').FlipClock(t,{
    clockFace:'HourlyCounter',
    countdown:true,
    callbacks:{
      stop(){
        let src=sound.files.length
          ? URL.createObjectURL(sound.files[0])
          : defaultAudioSrc;
        alarmAudio=new Audio(src);
        alarmAudio.loop=true;
        alarmAudio.play();
        alarmTimeout=setTimeout(()=>{
          alarmAudio.pause();
          alarmAudio.currentTime=0;
          timerInputs.style.display="block";
          $('.timer').html('');
        },30000);
      }
    }
  });
}

/* FULLSCREEN TOGGLE */
function goFullscreen(){
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen();
    fullBtn.innerText="Normal";
  }else{
    document.exitFullscreen();
    fullBtn.innerText="Full";
  }
}
document.addEventListener("fullscreenchange",()=>{ fullBtn.innerText=document.fullscreenElement?"Normal":"Full"; });

/* AUTO FULLSCREEN ON MOBILE PORTRAIT */
function autoFullscreenOnLoad(){
  const isMobile=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
  const isPortrait=window.matchMedia("(orientation: portrait)").matches;
  if(isMobile && isPortrait && !document.fullscreenElement){
    document.documentElement.requestFullscreen().catch(()=>{});
  }
}
window.addEventListener("load", autoFullscreenOnLoad);
window.addEventListener("orientationchange", autoFullscreenOnLoad);
</script>

</body>
</html>

